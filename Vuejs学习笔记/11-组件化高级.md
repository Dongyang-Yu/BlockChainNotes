# slot插槽的使用

## 为什么要使用插槽

* slot翻译为插槽：
  * 在生活中很多地方都有插槽，电脑的USB插槽，插板中的电源插槽。
  * 插槽的目的是让我们原来的设备具备更多的扩展性。
  * 比如电脑的USB我们可以插入U盘、硬盘、手机、音响、键盘、鼠标等等。
* 组件的插槽：
  * 组件的插槽也是为了让我们封装的组件<u>更加具有扩展性</u>。
  * 让使用者可以决定组件内部的一些内容到底展示什么。

* 举例：移动网站中的导航栏。
  * 移动开发中，几乎每个页面都有导航栏。
  * 导航栏我们必然会封装成一个插件，比如nav-bar组件。
  * 一旦有了这个组件，我们就可以在多个页面中复用了。
  * ![image-20201020185649909](11-%E7%BB%84%E4%BB%B6%E5%8C%96%E9%AB%98%E7%BA%A7.assets/image-20201020185649909.png)

## 封装这类组件(slot)

* 如何去封装这类的组件呢？
  * 它们有很多区别，但也有很多共性。
  * 如果我们每一个都单独去封装组件，显然不合适：比如每个页面都返回，这部分内容我们就要重复去封装。
  * 但是，如果我们封装成一个，好像也不合理：有些左侧是菜单，有些是返回，有些中间是搜索，有些是文字等等。
* 如何封装合适呢？抽取共性，保留不同。
  * 最好的封装方式就是将<u>共性</u>抽取到组件中，将<u>不同暴露为插槽</u>。
  * 一旦我们预留了插槽，就可以让使用者根据自己的需求，决定插槽中插入什么内容。
  * 是搜索框，还是文字，还是菜单，由调用者自己来决定。

# slot基本使用

* 在子组件中，使用特殊的元素`<slot>`就可以为子组件开启一个插槽。
* 该插槽插入什么内容取决于父组件如何使用。
* `slot`中的内容表示，如果没有在该组件中插入任何其它内容，就默认显示该内容。
  * 插槽的基本使用 `<slot><....></slot>`
  2. 插槽的默认值 `<slot>button</slot>`
  3. 如果有多个值同时放入到组件进行替换时，一起作为替换元素

```html
<div id="app">
  <cpn>
    <h4>我是多个值</h4>
    <u>呵呵呵呵呵</u>
    <button>案例</button>
  </cpn>
  <cpn><span>哈哈哈</span></cpn>
  <cpn></cpn>
  <cpn></cpn>
  <cpn></cpn>
</div>

<template id="cpn">
  <div>
    <h2>我是组件</h2>
    <p>我是组件段落</p>
    <slot>
      <p>我是默认值</p>
    </slot>

  </div>
</template>
```

![image-20201021081553029](11-%E7%BB%84%E4%BB%B6%E5%8C%96%E9%AB%98%E7%BA%A7.assets/image-20201021081553029.png)

# 具名插槽slot的使用

* 当子组件的功能复杂时，子组件的插槽可能并非是一个。
  * 比如我们封装一个导航栏的子组件，可能就需要三个插槽，分别代表左边、中间、右边。
  * 那么，外面在给插槽插入内容时，如何区分插入的是哪一个呢？
  * 这个时候，我们就需要给插槽起一个名字。
* 如何使用具名插槽呢？
  * 只要给slot元素一个name属性即可
  * `slot name="xxx"></slot`
  * ![image-20201021082700062](11-%E7%BB%84%E4%BB%B6%E5%8C%96%E9%AB%98%E7%BA%A7.assets/image-20201021082700062.png)

# 编译作用域

* 在真正学习插槽之前，我们需要先理解一个概念：编译作用域。

* 官方对于编译的作用域解析比较简单，我们自己来通过一个例子来理解这个概念：

* 我们来考虑下面的代码是否最终是可以渲染出来的：

  * `<cpn v-show="isShow"></cpn>`，我们使用了isShow属性。isShow属性包含在组件中，也包含中Vue实例中。

  * ![image-20201021084921229](11-%E7%BB%84%E4%BB%B6%E5%8C%96%E9%AB%98%E7%BA%A7.assets/image-20201021084921229.png)
  * cpn可以被渲染，但是button不能被渲染。理由如下
    * 官方给出了一条准则：**父组件模板的所有东西都会在父级作用域内编译；子组件模板的所有东西都会在子级作用域内编译。**
    * 而我们在使用`<cpn v-show="isShow"></cpn>`的时候，整个组件的使用过程是相当于在<u>父组件</u>中出现的。那么它的作用域就是父组件，使用的属性也是属于父组件的属性。
    * 因此，cpn的isShow使用的是Vue实例中的属性，而不是子组件的属性。而button的isShow相反，是在子组件中出现的，所以其作用域为子组件，因此不显示。

# 作用域插槽：准备

> **作用域插槽要求，在slot上面绑定数据**

* 父组件替换插槽的标签，但是内容由子组件来提供。

* 假如子组件中包括一组数据，比如`pLanguages: ['JavaScript', 'C++', 'Java', 'C#', 'Go', 'Swift']`
  * 需要在多个界面上进行展示：
    * 某些界面是以水平方向展示的。
    * 某些界面是以列表形式展示的，
    * 某些界面直接展示一个数组。
  * 内容在子组件，希望父组件告诉我们如何展示，怎么办呢？
    * 利用slot<u>作用域插槽</u>即可

```html
<div id="app">
  <cpn></cpn>
  <cpn>
    <!--目的是获取子组件中的pLanguage-->
    <template v-slot="obj">
<!--      <span v-for="item in obj.data">{{item}} - </span>-->
      <span>{{obj.data.join(' - ')}}</span>
    </template>
  </cpn>

</div>

<template id="cpn">
  <div>
    <slot :data="pLanguages">
      <ul>
        <li v-for="item in pLanguages">{{item}}</li>
      </ul>
    </slot>
  </div>
</template>
```

## 具体步骤

1. `<slot>` 元素上动态绑定要在外面访问的对象，此处为`data`，如果不绑定，外面是访问不了的。
2. 父组件中定义一个名字，<u>通过该名字访问子组件中的对象</u>，用`v-slot`定义一个对象名，如此处的obj。但注意必须<u>用在标签`template`下</u>才可以。

